
<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="jquery.mobile-1.4.0.min.css">
    <script src="jquery-2.1.0.min.js"></script>
    <script src="jquery.mobile-1.4.0.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta charset="UTF-8" />
    <meta name="Description" content="" />
    <meta name="Keywords"  content="" />
</head>
<body>
   

    
<div data-role="page" id="mainPage" data-theme="b">
    <div data-role="panel" id="contact" data-display="overlay"> 
    <h1>Contact Us</h1>
  
  
    <p>Assalamu Alaykum, this is the Islamic Association of Saskatchewan mobile application. Please feel free to contact us (IAS Youth) if you have any suggestions for improvement, or general questions.</p>
      
      <a data-icon="info" data-inline="true" data-role="button" href="mailto:iasyouthm@gmail.com?Subject=IAS%20App" target="_top">Email Us</a>
  

    </div>
  <div data-role="header" data-position="fixed" >
      <a href="#contact" class="ui-btn ui-btn-inline ui-corner-all ui-shadow">Contact Us</a>
      <h1>IAS</h1>
      <a class="refresh" href="#" data-role="button" data-icon="refresh" data-iconpos="notext"></a>
  </div> 
    
  <div data-role="content"> 
     <div id="fb-root"></div>
    <script>
      window.fbAsyncInit = function() {
        FB.init({
          appId      : '{1472493829633399}',
          status     : true,
          xfbml      : true
        });
      };

      (function(d, s, id){
         var js, fjs = d.getElementsByTagName(s)[0];
         if (d.getElementById(id)) {return;}
         js = d.createElement(s); js.id = id;
         js.src = "https://connect.facebook.net/en_UK/all.js";
         fjs.parentNode.insertBefore(js, fjs);
       }(document, 'script', 'facebook-jssdk'));
    </script>
    
      <p>"Allah says, 'I am as my servant expects Me to be, and I am with him when he remembers me. If he thinks of Me, I think of him. If he mentions Me in company, I mention him in an even better company. When he comes closer to Me by a handspan, I come closer to him an arm's length. If he draws closer to Me by an arm's length, I draw closer by a distance of two outstretched arms nearer to him. If my servant comes to Me walking, I go to him running." (Al-Bukhari)</p>
      <br>
      <a id="Prayers" data-role="button" href="#prayerPage" data-transition="slide" >Prayer Timings</a>
      <br>
      <a id="Questions" data-role="button" href="#emailPage" data-transition="slide" >Islamic Questions?</a>
      <br>
      <a id="Events" data-role="button" href="#EventsPage" data-transition="slide" >Upcoming Events</a>
      <br>
      <a id="Games" data-role="button" href="#gamePage" data-transition="slide" >The Game</a>
      <label>Current Top Players</label>
      <ol id="scores">
          
      </ol>
      <br><br><hr>
      <h4>Latest Community Announcement</h4>
      <div id="announcements">
          
      </div>
  </div>

 
</div> 
    
<div data-role="page" id="emailPage" data-theme="b">
  <div data-role="header" data-position="fixed" >
      <a data-role="button" href="#" data-transition="slide" data-rel="back" data-icon="back">Back</a>
      <h1>Ask A Question</h1>
  </div>
    
  <div data-role="content">
      <p>"And say: My Lord increase me in knowledge." (Qur'an, Ta-Ha 20:114)</p>
          <p>Have a question in islam, just ask and you will receive a reply by email. In Sha Allah.</p>
          <a data-icon="info" data-inline="true" data-role="button" href="mailto:imamsask@yahoo.ca?Subject=Question%20From%20IAS%20App" target="_top">Email Imam Alyas</a>
  </div>

  
</div> 

    
<div data-role="page" id="gamePage" data-theme="b">
  <div data-role="header" data-position="fixed" >
      <a id="gameBack" data-role="button" href="#" data-transition="slide" data-rel="back" data-icon="back">Back</a>
      <h1>Games</h1>
      <div ><input type="text" value="" id="timeMeter" /></div> 
  </div>
    
  <div data-role="content">
     <p>'You shall certainly travel from stage to stage' (in this life and in the Hereafter). Quran - Chp. 84 v. 19</p>
      <input type="button" id="startG" value="Start A New Game"/>
      <br>
        <div id="container"></div>
         
  </div>
    
    
  
</div> 
 
    
<div data-role="page" id="prayerPage" data-theme="b">
  <div  data-role="header" data-position="fixed" >
      <a data-role="button" href="#" data-transition="slide" data-rel="back" data-icon="back">Back</a>
      <h1>Prayer Timings</h1>
      <a class="refresh" href="#" data-role="button" data-icon="refresh" data-iconpos="notext"></a>
  </div>
   
  <div data-role="content" id="yql">
    <label>“Prayer in congregation is superior to prayer alone by twenty seven degrees.” [Bukhari & Muslim]</label>
      <br>
    <div data-role="collapsible-set">
      <div data-role="collapsible" data-collapsed="false">
        <h1 id="eastPrayers" >East-Side Masjid</h1>
        <label id="fajr"></label>
        <label id="duhr"></label>
        <label id="asr"></label>
        <label id="maghrib"></label>
        <label id="isha"></label><br>
        <label id="jumma1"></label>
        <label id="jumma2"></label>
      </div>
      
      <div data-role="collapsible" data-collapsed="true">
        <h1 id="westPrayers" >West-Side Masjid</h1>
        <label id="fajrWest"></label>
        <label id="duhrWest"></label>
        <label id="asrWest"></label>
        <label id="maghribWest"></label>
        <label id="ishaWest"></label><br>
        <label id="jumma1West"></label>
        <label id="jumma2West"></label>
      </div>
        
      <div data-role="collapsible" data-collapsed="true">
        <h1 id="campusPrayers" >On-Campus Prayer Room</h1>
        <label id="duhrCampus">Duhr: 1:30</label>
        <label id="asrCampus"></label>
      </div>
        
    </div>
   
  </div>

  
</div> 
    
<div data-role="page" id="EventsPage" data-theme="b">
  <div data-role="header" data-position="fixed" >
    <a data-role="button" href="#" data-transition="slide" data-rel="back" data-icon="back">Back</a>
      <h1>Events</h1>
      <a class="refresh" href="#" data-role="button" data-icon="refresh" data-iconpos="notext"></a>
  </div>

  <div data-role="content">
      <p>"None of you will believe until you love for your brother what you love for yourself." [Bukhari & Muslim]</p>
      <div class="fb-comments" data-mobile="true" data-href="http://iasforyouth.appspot.com/" data-numposts="5" data-colorscheme="dark"></div>
      <br><br>
      <div data-role="collapsible" data-collapsed="false">
          <h1>General Events<span id="generalNum" class="ui-li-count ui-btn-up-c ui-btn-corner-all"></span></h1>
          <div id="generalEvent"></div>
      </div>
      <br>
      <div data-role="collapsible-set">
          <div data-role="collapsible" data-collapsed="true">
            <h1>Exclusive To Brothers<span id="brotherNum" class="ui-li-count ui-btn-up-c ui-btn-corner-all"></span></h1>
            <div id="brotherEvent"></div>
          </div>
          <div data-role="collapsible" data-collapsed="true">
            <h1>Exclusive To Sisters<span id="sisterNum" class="ui-li-count ui-btn-up-c ui-btn-corner-all"></span></h1>
            <div id="sisterEvent"></div>
          </div>
      </div>
  </div>


</div> 

</body>
</html>

<script type="text/javascript" src="http://jindo.dev.naver.com/collie/deploy/collie.min.js"></script>
<script type="text/javascript" src="http://jindo.dev.naver.com/collie/deploy/collie.addon.min.js"></script>
<script type="text/javascript" src="http://jsdo.it/laphroaig/json2/js"></script>
<script type="text/javascript" src="http://jsdo.it/laphroaig/jquery.yql/js"></script>

<script>
    var $yql;
    
    
    $(document).ready(function(){
       $yql = $("#yql");
        
        loadData(); 
        
        $('.refresh').click(function() {
           loadData(); 
            alert("New Data Loaded"); 
         });
        
        $('#Prayers').click(function() {
         $.ajax({
                type: "POST",
                url: "http://khaledyhaggag.appspot.com/research",
                xhrFields: { withCredentials: true},
                data: { Channel: "IAS", Status: "Prayer" }
            });
        });
        
        $('#Events').click(function() {
            $.ajax({
                type: "POST",
                url: "http://khaledyhaggag.appspot.com/research",
                xhrFields: { withCredentials: true},
                data: { Channel: "IAS", Status: "Event" }
            });
        }); 
        
        $('#Questions').click(function() {
            $.ajax({
                type: "POST",
                url: "http://khaledyhaggag.appspot.com/research",
                xhrFields: { withCredentials: true},
                data: { Channel: "IAS", Status: "Question" }
            });
        }); 
        
        $('#Games').click(function() {
         $.ajax({
                type: "POST",
                url: "http://khaledyhaggag.appspot.com/research",
                xhrFields: { withCredentials: true},
                data: { Channel: "IAS", Status: "Gane" }
            });
        });
        
        
    }); 
    
    
    
    function loadData(){
        //first check if there is an internet connection
        $.ajaxSetup({
            timeout: 3000, // Microseconds, for the laughs.  Guaranteed timeout.
            error: function(request, status, maybe_an_exception_object) {
                if(status == 'timeout')
                    alert("No internet connection has been detected. This application requires an active internet connection to function properly. Sorry, please try again when you have a stable connection.");
            }
        });
        
        var fajrEast = "NA";
        var duhrEast = "NA";
        var asrEast= "NA"; 
        var maghribEast = "NA";
        var ishaEast = "NA"; 
        var jumma1East = "NA"; 
        var jumma2East = "NA";
                    
                
        var fajrWest = "NA";
        var duhrWest = "NA";
        var asrWest = "NA";
        var maghribWest = "NA";
        var ishaWest = "NA";
        var jumma1West = "NA";
        var jumma2West = "NA";
        
        var duhrCampus = "NA";
        var asrCampus = "NA"; 
        
        
    
        $.yql.getHTML('http://www.imamilyas.com/index.html', {
                xpath: '//div',
                format: 'json',
                callback: function(data){
                    
                    fajrEast = data.query.results.div[4].div.div[11].div.div.div.div.div.table.tbody.tr[0].td[1].p;
                    duhrEast = data.query.results.div[4].div.div[11].div.div.div.div.div.table.tbody.tr[1].td[1].p;
                    asrEast = data.query.results.div[4].div.div[11].div.div.div.div.div.table.tbody.tr[2].td[1].p;
                    maghribEast = data.query.results.div[4].div.div[11].div.div.div.div.div.table.tbody.tr[3].td[1].p;
                    ishaEast = data.query.results.div[4].div.div[11].div.div.div.div.div.table.tbody.tr[4].td[1].p;
                    jumma1East = data.query.results.div[4].div.div[11].div.div.div.div.div.table.tbody.tr[5].td[1].p;
                    jumma2East = data.query.results.div[4].div.div[11].div.div.div.div.div.table.tbody.tr[6].td[1].p;
                    
                    
                    fajrWest = data.query.results.div[4].div.div[12].div.div.div.div.div.table.tbody.tr[0].td[1].p;
                    duhrWest = data.query.results.div[4].div.div[12].div.div.div.div.div.table.tbody.tr[1].td[1].p;
                    asrWest = data.query.results.div[4].div.div[12].div.div.div.div.div.table.tbody.tr[2].td[1].p;
                    maghribWest = data.query.results.div[4].div.div[12].div.div.div.div.div.table.tbody.tr[3].td[1].p;
                    ishaWest = data.query.results.div[4].div.div[12].div.div.div.div.div.table.tbody.tr[4].td[1].p;
                    jumma1West = data.query.results.div[4].div.div[12].div.div.div.div.div.table.tbody.tr[5].td[1].p;
                    jumma2West = data.query.results.div[4].div.div[12].div.div.div.div.div.table.tbody.tr[6].td[1].p;
                    
                    //duhrCampus = duhrEast;
                    //asrCampus = asrEast;
                    
                    $('#fajr').html("Fajr:  "+"<b>"+fajrEast +"</b>");
                    $('#duhr').html("Duhr:  "+duhrEast);
                    $('#asr').html("Asr:  "+asrEast);
                    $('#maghrib').html("Maghrib:  "+maghribEast);
                    $('#isha').html("Isha:  "+"<b>"+ishaEast+"</b>");
                    $('#jumma1').html("Jumma 1:  "+jumma1East);
                    $('#jumma2').html("Jumma 2:  "+jumma2East);
            
                    $('#fajrWest').html("Fajr:  "+"<b>"+fajrWest+"</b>");
                    $('#duhrWest').html("Duhr:  "+duhrWest);
                    $('#asrWest').html("Asr:  "+asrWest);
                    $('#maghribWest').html("Maghrib:  "+maghribWest);
                    $('#ishaWest').html("Isha:  "+"<b>"+ishaWest+"</b>");
                    $('#jumma1West').html("Jumma 1:  "+jumma1West);
                    $('#jumma2West').html("Jumma 2:  "+jumma2West);
                    
                    //$('#duhrCampus').html("Duhr:  "+duhrCampus);
                    //$('#asrCampus').html("Asr:  "+asrCampus);
                }
        });
        
        var latestAnnouncement = "NA";
        
        $.yql.getHTML('http://www.islamiccenter.sk.ca/announcements', {
                xpath: '//div',
                format: 'json',
                callback: function(data){
                    $("#announcements").empty(); 
                    
                    latestAnnouncement = data.query.results.div[0].div[2].div[2].div.div.div[0].div.div[0].div.div.div[1].div.p[0].strong.span.span[0].content; 
                    
                    $("#announcements").append("<p>"+ latestAnnouncement +"</p>"); 
                }
        });
        
        
        
            
        
        
        var bCount = 0;
        var sCount = 0;
        var gCount = 0;
         $.getJSON( "http://iasforyouth.appspot.com/loadEvents?callback=?", function( json ) {
             $("#brotherEvent").empty(); 
             $("#sisterEvent").empty(); 
             $("#generalEvent").empty();
             
           json.forEach(function(event) {
               var showingDate = event.DateTime.slice(0,9).split("-");
               var showingTime = event.DateTime.slice(11,16); 
               
               var year = showingDate[0]; 
               var month = getMonth(showingDate[1]); 
               var day = showingDate[2];
               
               var finalDateTime = month + ", " + day + ", " + year + ". At " + tConvert(showingTime); 
               
               if(event.Gender == "Brother's Event"){
                   bCount ++;
                   $("#brotherEvent").append("<fieldset><legend>"+event.Title+"</legend><ul>" +
                            "<li><label>"+finalDateTime+"</label></li>" +
                            "<li><label>"+event.Location+"</label></li>" +
                            "<li><label>"+event.Description+"</label></li>" +
                        "</ul></fieldset>"); 
               }else if(event.Gender == "Sister's Event"){
                   sCount ++; 
                   $("#sisterEvent").append("<fieldset><legend>"+event.Title+"</legend><ul>" +
                            "<li><label>"+finalDateTime+"</label></li>" +
                            "<li><label>"+event.Location+"</label></li>" +
                            "<li><label>"+event.Description+"</label></li>" +
                        "</ul></fieldset>"); 
               } else {
                   gCount ++; 
                   $("#generalEvent").append("<fieldset><legend>"+event.Title+"</legend><ul>" +
                            "<li><label>"+finalDateTime+"</label></li>" +
                            "<li><label>"+event.Location+"</label></li>" +
                            "<li><label>"+event.Description+"</label></li>" +
                        "</ul></fieldset>"); 
            }
           });
             $("#brotherNum").html(bCount); 
             $("#sisterNum").html(sCount); 
             $("#generalNum").html(gCount); 
       });
        
        $.getJSON( "http://iasforyouth.appspot.com/topScores?callback=?", function( json ) { 
            $("#scores").empty();
            
            json.forEach(function(sc) {
                $("#scores").append("<li>" + sc.Name  + ": " + sc.Score + "</li>");
            });
        });
                  
                  
    }
   
    

    
    
    
    function getMonth(num){
        var monthNames = [ "January", "February", "March", "April", "May", "June",
        "July", "August", "September", "October", "November", "December" ];
        num = parseInt(num); 
        
        return monthNames[num]; 
    }
    
    function tConvert (time) {
        // Check correct time format and split into components
        time = time.toString ().match (/^([01]\d|2[0-3])(:)([0-5]\d)(:[0-5]\d)?$/) || [time];

        if (time.length > 1) { // If time format correct
            time = time.slice (1);  // Remove full string match value
            time[5] = +time[0] < 12 ? 'AM' : 'PM'; // Set AM/PM
            time[0] = +time[0] % 12 || 12; // Adjust hours
        }
        
        return time.join (''); // return adjusted time or original string
    }
    
        
        
</script>


<script>
    //Everything with the game
    
    $(document).ready(function(){
        
        $('#gameBack').click(function() {
           collie.Renderer.stop(); 
         });
    }); 
    function postScore(s){
         var c = confirm("You have a high score of: " + s + ". Would you like to post it?");
            if (c == true) {
                var person = prompt("Please enter your name","Anonymous");
                if (person!=null)
                {
                    alert('send'); 
                    $.ajax({
                        type: "POST",
                        url: "http://iasforyouth.appspot.com/topScores",
                        xhrFields: { withCredentials: true},
                        data: { Name: person, Score: s }
                    });
                }
            } 
    }
    
    
    
    function startGame(){
        
        var screenWidth = window.screen.width;
        var screenHeight = 250;
        
        var secondsOfLife = 60*2; 
            
        var goodDeeds = 0; 
        var sins = 0;
        
            
        collie.Renderer.RETINA_DISPLAY = "auto";
            var folder = collie.Renderer.isRetinaDisplay() ? "large" : "small";
            collie.ImageManager.add({
                rabbit: "http://jindo.dev.naver.com/collie/img/" + folder + "/yame_walk.png",
                ground: "http://jindo.dev.naver.com/collie/img/" + folder + "/ground.png"
            });
                                    
            var layer = new collie.Layer({
                width: screenWidth,
                height: screenHeight
        	});

           

            alert("Let us begin with life as a baby..."); 
            
            var secs = secondsOfLife;
            var oTimer = collie.Timer.repeat(function (e) {
                // callback
                if (secs == 1) {
                    oTimer.stop();
                    alert("GAME OVER. As you pass to the next stage you carry with you " + goodDeeds + " good deeds, but also " + sins + " sins.");
                    collie.Renderer.stop();
                    postScore(goodDeeds - sins); 
                } else if (secs == 100) {
                    c = confirm("You have now entered your childhood years. Will you focus more on education and physical activity?");
                    if (c == true) {
                        var generator3 = collie.Timer.repeat(function(e){
                        var box = new collie.DisplayObject({
                            x : screenWidth - 20,
                            y : 5,
                            width : 10,
                            height : 10,
                            backgroundColor : "green",
                            velocityX : -120
                        }).addTo(layer);
	   
                        sensor.addListener(box, "rabbit", function (a, b) {
                            layer.removeChild(a);
                            goodDeeds += 7;
                        }, function (a, b) {
                            //no touch
                            });
                        }, 5000);
                    }
                } else if (secs == 70) {
                    c = confirm("You have now entered your teenage years. Will you start smoking?");
                    if (c == true) {
                        var generator5 = collie.Timer.repeat(function (e) {
                            var box = new collie.DisplayObject({
                                x: screenWidth - 20,
                                y: 210,
                                width: 10,
                                height: 10,
                                backgroundColor: "red",
                                velocityX: -190
                            }).addTo(layer);

                            sensor.addListener(box, "rabbit", function (a, b) {
                                layer.removeChild(a);
                                sins++;
                            }, function (a, b) {
                                //no touch
                            });
                        }, 6000); 
                    }
                } else if (secs == 40) {
                    c = confirm("You have now entered your adult years. Will you get married and have an islamic wedding?");
                    if (c == true) {
                        var generator4 = collie.Timer.repeat(function(e){
                        var box = new collie.DisplayObject({
                            x : screenWidth - 20,
                            y : 35,
                            width : 10,
                            height : 10,
                            backgroundColor : "green",
                            velocityX : -200
                        }).addTo(layer);
	   
                        sensor.addListener(box, "rabbit", function (a, b) {
                            layer.removeChild(a);
                            goodDeeds += 7;
                        }, function (a, b) {
                            //no touch
                            });
                        }, 3000);
                    }
                }

                //update time
                secs--;
                document.getElementById("timeMeter").value = "Seconds to live: " + secs;

            }, 1000 /* interval(ms) */);
            
            var sensor = new collie.Sensor({
                frequency : 0
            });

            var generator1 = collie.Timer.repeat(function (e) {
                var box = new collie.DisplayObject({
                    x: screenWidth - 20,
                    y: 230,
                    width: 10,
                    height: 10,
                    backgroundColor: "red",
                    velocityX: -100
                }).addTo(layer);

                sensor.addListener(box, "rabbit", function (a, b) {
                    layer.removeChild(a);
                    sins++;
                }, function (a, b) {
                    //no touch
                });
            }, 10000); 
            
            var generator2 = collie.Timer.repeat(function(e){
                var box = new collie.DisplayObject({
                    x : screenWidth - 20,
                    y : 20,
                    width : 10,
                    height : 10,
                    backgroundColor : "green",
                    velocityX : -170
                }).addTo(layer);
	   
                sensor.addListener(box, "rabbit", function (a, b) {
                    layer.removeChild(a);
                    goodDeeds += 7;
                }, function (a, b) {
                    //no touch
                });
            }, 6000);

//            var rabbit = new collie.DisplayObject({
//		   		x: 100,
//				width: 70,
//				height: 160,
//				zIndex: 2,
//				backgroundImage: "rabbit"
//			}).bottom(50).addTo(layer);
            
            var rabbit = new collie.DisplayObject({
                x: 75,
                width: 70,
                height : 150,
                zIndex: 2,
                backgroundColor: "black"
            }).bottom(10).addTo(layer); 
            
            sensor.add(rabbit,"rabbit");
            
            
            
			var currentY = rabbit.get("y");

			var jumping = false;
			setInterval(function () { jumping = false; }, 2550);

			layer.attach({
			    click: function (e) {
			        if (jumping == false) {
			            jumping = true;
			            collie.Timer.queue().
			 	        transition(rabbit, 500, {
			 	            to: currentY - 90,
			 	            effect: collie.Effect.easeOut,
			 	            set: "y"
			 	        }).
			 	        transition(rabbit, 2000, {
			 	            to: currentY,
			 	            effect: collie.Effect.easeIn,
			 	            set: "y"
			 	        });
			        }
			    }
			});
		 
			collie.Timer.cycle(rabbit, "18fps", {
				from: 0,
				to: 8,
				loop: 0
			});
			
			var ground = new collie.DisplayObject({
		 		x: 0,
		  		width: screenWidth * 2,
		  		height: 88,
		  		velocityX: -200,
		  		backgroundImage: "ground",
		  		backgroundRepeat: "repeat-x",
		  		rangeX: [-screenWidth, 0],
		  		positionRepeat: true
		  	}).bottom(0).addTo(layer);
		  
            sensor.start(); 
            
		  	collie.Renderer.addLayer(layer);
		  	collie.Renderer.load(document.getElementById("container"));
		  	collie.Renderer.start();
    }
    
    $('#startG').click(function() {
        startGame();
    });
    
    
</script>
